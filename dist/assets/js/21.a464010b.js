(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{414:function(e,t,i){"use strict";i.d(t,"j",(function(){return d})),i.d(t,"i",(function(){return h})),i.d(t,"k",(function(){return g})),i.d(t,"a",(function(){return m})),i.d(t,"e",(function(){return b})),i.d(t,"m",(function(){return y})),i.d(t,"f",(function(){return v})),i.d(t,"g",(function(){return j})),i.d(t,"l",(function(){return w})),i.d(t,"b",(function(){return F})),i.d(t,"d",(function(){return k})),i.d(t,"c",(function(){return S})),i.d(t,"h",(function(){return x}));var r=i(49),n=i(37),o=i(5),a=i(39),s=(i(117),i(156),i(158),i(11),i(29),i(59),i(119),i(118),i(121),i(122),i(20),i(247),i(24),i(157),i(84),i(38),i(238),i(246),i(120),i(31),i(30),i(243),i(244),i(245),i(242),{required:{message:"请[action][label]",trigger:"change",required:!0},email:{type:"email",message:"请输入正确的邮箱地址",trigger:["blur","change"]},url:{type:"url",message:"请输入正确的网址",trigger:["blur","change"]},integer:{type:"integer",message:"请输入正确的[label]",trigger:["blur","change"]},regexp:{type:"regexp",message:"请[action]正确的[label]",trigger:["blur","change"]},customRegexp:{validator:function(e,t,i){e.regexp.test(t)?i():i(new Error(e.message))},message:"请[action]正确的[label]",trigger:["blur","change"]}});function l(e,t,i){if("string"==typeof e){var r=s[e];return Object(o.a)(Object(o.a)({},r),{},{message:c(r.message,u[t],i)})}if(e instanceof RegExp){var a=s.customRegexp;return Object(o.a)(Object(o.a)({},a),{},{regexp:e,message:c(a.message,u[t],i)})}return"object"==Object(n.a)(e)?e:{validator:e,trigger:"blur",required:!0}}function c(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"完善",i=arguments.length>2?arguments[2]:void 0;return(e=e.replace(/\[label\]/,i)).replace(/\[action\]/,t)}var u={FormRadio:"选择",FormSelect:"选择",FormInput:"填写",FormDate:"填写",FormDateRange:"填写",FormDateTime:"填写",FormMoneyInput:"填写",FormNumberInput:"填写",FormNormalNumber:"填写",FormRateNumber:"填写",FormTextareaNumber:"填写"},p=i(415);function d(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=["",void 0,null];return(i=t?i.concat(["undefined","null"]):i).includes(e)}var f=function(e){return Object.prototype.toString.call(e).toLowerCase().replace(/^\[object\s(\w+)\]$/,(function(){return arguments.length<=1?void 0:arguments[1]}))};function h(e){return null!=e}function g(e){return!!["[]","{}"].includes(JSON.stringify(e))}function m(e){return JSON.parse(JSON.stringify(e))}function b(e){var t=["object","array"];if(!t.includes(f(e)))return"必须传入对象或数组";var i=Array.isArray(e)?[]:{};for(var r in e)e.hasOwnProperty(r)&&(t.includes(f(e[r]))?i[r]=b(e[r]):i[r]=e[r]);return i}function O(e){return["object","array"].includes(f(e))}function y(e,t){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(["object","array"].includes(f(e)))for(var r in e)["object","array"].includes(f(e[r]))?y(e[r],t):(e[r]=t(r,e),i&&!h(e[r])&&delete e[r]);return e}function v(e,t){var i,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];for(i in e=b(e),t)if(e[i]&&t[i]&&["object"].includes(f(e[i]))){if(f(e[i])==f(t[i])){e[i]=v(e[i],t[i],r);continue}console.warn("合并对象异常,类型不匹配："+i)}else if(Array.isArray(e[i])){if(Array.isArray(t[i])){e[i].some((function(e){return O(e)}))?e[i]=Array.from(new Set([].concat(Object(a.a)(e[i]),Object(a.a)(t[i])))):e[i]=t[i];continue}console.warn("合并数组异常,类型不匹配："+i)}else h(t[i])||!r?e[i]=t[i]:delete e[i];return e}function j(e,t){var i,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!["object","array"].includes(f(e)))return e;for(i in r&&(e=b(e)),t)if(e[i]&&t[i]&&["object","array"].includes(f(e[i]))){if(f(e[i])==f(t[i])){e[i]=j(e[i],t[i],r);continue}console.warn("合并对象异常,类型不匹配："+i)}else h(t[i])?e[i]=t[i]:delete e[i];return e}function w(e){return p.a[e]||{}}var P={wraperProperties:{class:["grid-col-8","grid-col-lg-6","grid-col-sm-8","grid-col-ss-12","grid-col-xs-24","grid-col-pp-24"]},rules:[],properties:{},events:{},valueLink:{}};function F(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"array"!==f(e)?[]:(e=(e=b(e)).filter((function(e){return e.formable||e.formOption})).map((function(e){var t=v(P,e.formOption,!0);delete e.tableOption,delete e.formOption,delete e.searchable,delete e.formable,delete e.tableable;var i=t.extra;return delete t.extra,e.type=e.type||"FormInput",Object(o.a)(Object(o.a)(Object(o.a)({},e),t),i)})).map((function(e){return e.rules=e.rules.filter((function(e){return["object","function","string"].includes(Object(n.a)(e))})).map((function(t){return l(t,e.type,e.label)})),e})).reduce((function(e,t){var i=t.formSection?t.formSection:"";return t.formSection=void 0,e[i]?e[i]=e[i].concat([Object(o.a)({},t)]):e[i]=[Object(o.a)({},t)],e}),{}),1==(e=Object.entries(e).map((function(e){var i=Object(r.a)(e,2),n=i[0],a=i[1],s=t[n]||{};return Object(o.a)({label:n,children:a},s)}))).length&&(e[0].label=void 0),e)}var C={template:function(e,t){var i;return null!==(i=e[t])&&void 0!==i?i:""}};function k(e){if("array"!==f(e))return[];var t=b(e);return t=t.filter((function(e){return e.tableable||e.tableOption})).map((function(e){return e.tableOption=v(C,e.tableOption,!0),Object(o.a)(Object(o.a)({},e),Object(o.a)({sort:100},e.tableOption))})).sort((function(e,t){return e.tableOption.sort-t.tableOption.sort})).map((function(e){return delete e.formOption,delete e.searchable,delete e.formable,delete e.tableable,delete e.tableOption.sort,e}))}var D={wraperProperties:{class:["grid-col-6","grid-col-lg-4","grid-col-sm-6","grid-col-ss-8","grid-col-xs-12","grid-col-pp-24"]},properties:{}};function S(e){if("array"!==f(e))return[];var t=b(e);return(t=t.filter((function(e){return e.searchable||e.searchOption})).map((function(e){var t=v(D,e.searchOption,!0);delete e.tableOption,delete e.formOption,delete e.searchOption;var i="FormRadio"==e.type?"FormSelect":e.type;return Object(o.a)(Object(o.a)({},e),{},{type:i},t)}))).length>0?[{children:t}]:[]}function x(e){return Math.round(Math.random()*e)}},415:function(e,t,i){"use strict";i.d(t,"e",(function(){return r})),i.d(t,"f",(function(){return n})),i.d(t,"c",(function(){return o})),i.d(t,"g",(function(){return a})),i.d(t,"b",(function(){return u})),i.d(t,"d",(function(){return p}));i(11);var r={properties:{"label-width":"80px","label-position":"right"},showTestTool:!0,borderForm:!1,trigger:"click",resetable:!0},n={dataList:[],hasCheckbox:!0,properties:{stripe:!0,border:!0,"row-class-name":"","highlight-current-row":!0,selectable:!0,expand:!0,"show-header":!0,"empty-text":"暂无数据",align:"center","header-align":"center","row-style":{height:"40px"}},colOptions:{minWidth:60,"show-overflow-tooltip":!0}},o={small:!1,"current-page":1,pageSize:10,layout:"total,sizes, prev, pager, next, jumper","hide-on-single-page":!0,"page-sizes":[10,20,30,40,50]},a={lazy:!0,"node-key":"deptId",props:{label:"deptName",children:"children",isLeaf:"leaf"},"current-node-key":null,"highlight-current":!0,fieldName:"test"},s={formProperties:{"hide-required-asterisk":!1,"label-width":"100px","label-position":"top"},borderForm:!1,showFoldBtn:!0,showTestTool:!0,textModel:!1},l={class:["grid-col-24"],apiPromise:function(){return Promise.resolve()},data:{},formOption:s,formItemList:[],actions:{cancel:{actionType:"close",label:"取消"}}},c={container:"el-dialog",properties:{title:"",width:"70%"},body:{props:s,formItemList:[],data:{},formDataUpdateHandle:function(e,t){},actions:{save:{component:"el-button",permission:"",actionType:"submit",label:"保存",isloadData:!1,apiPromise:function(){return Promise.resolve()},properties:{type:"primary",size:"mini"},callback:{closeModal:!0,showTip:!0,refresh:!0}},cancel:{component:"el-button",isloadData:!1,properties:{type:"default",size:"small"},actionType:"close",label:"取消"}}}},u={component:"el-button",label:"",actionType:"dialogForm",permission:"",isloadData:!0,properties:{type:"primary",size:"small",key:""},dialog:c},p={component:"el-button",label:"",permission:"",actionType:"requestApi",properties:{type:"default",size:"small"},popconfirm:{"confirm-button-text":"好的","cancel-button-text":"不用了",title:"确定执行该操作吗？",icon:"el-icon-warning"},apiPromise:function(){return Promise.resolve()},callback:{showTip:!0,refresh:!0}};t.a={searchForm:r,tableOption:n,pagination:o,treeOption:a,formOption:s,DynamicForm:l,dialogFormOption:c,dialogPageActionOption:{component:"el-button",label:"",actionType:"dialogPage",properties:{type:"default",size:"small",key:""},permission:"",dialog:{properties:{title:""},container:"dy-page",layout:"LayoutGrid",body:[]}},dialogFormActionOption:u,requestApiActionOption:p}},420:function(e,t,i){var r=i(3),n=i(40),o=i(16),a=/"/g,s=r("".replace);e.exports=function(e,t,i,r){var l=o(n(e)),c="<"+t;return""!==i&&(c+=" "+i+'="'+s(o(r),a,"&quot;")+'"'),c+">"+l+"</"+t+">"}},421:function(e,t,i){var r=i(4);e.exports=function(e){return r((function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3}))}},423:function(e,t,i){"use strict";var r=i(2),n=i(420);r({target:"String",proto:!0,forced:i(421)("link")},{link:function(e){return n(this,"a","href",e)}})},588:function(e,t,i){"use strict";var r=i(5),n=(i(423),i(119),i(414));t.a={props:{},computed:{},methods:{actionHandles:function(){var e,t=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;switch(i.actionType){case"dialogPage":"el-drawer"==(e=i.dialog).container&&(e.properties=Object(r.a)({size:e.properties.width,direction:"rtl"},e.properties)),this.dialogPageHandle(i,n);break;case"dialogForm":"el-drawer"==(e=i.dialog).container&&(e.properties=Object(r.a)({size:e.properties.width,direction:"rtl"},e.properties)),this.dialogFormHandle(i,n);break;case"requestApi":this.requestApiHandle(i,n);break;case"submit":var o=this.$refs.DynamicFormContent||this.$parent.$refs.DynamicFormContent;o?o.validate((function(e,r){console.log("---submit---",r),e&&t.requestApiHandle(i,r)})):console.warn("submit 动作 在组件中没有定义对应的 DynamicFormContent 表单 ref,");break;case"reset":var a=this.$refs.DynamicFormContent||this.$parent.$refs.DynamicFormContent;a?a.resetFields():console.warn("submit 动作 在组件中没有定义对应的 DynamicFormContent 表单 ref,");break;case"close":this.closeModalHandle(i);break;case"link":this.linkHandle(i);break;case"router":this.routerHandle(i);break;default:this.customActionHandle(i,n)}},requestApiHandle:function(e,t){var i=this,r="function"==typeof e.dataAdapter?e.dataAdapter:function(e){return e};e.apiPromise(t).then(r).then((function(t){if(e.callback instanceof Object)for(var r in e.callback)"function"==typeof i[r+"Handle"]&&i[r+"Handle"](e.callback[r],t)}))},closeModalHandle:function(e){this.closeModal(this)},closeModal:function(e){if(e.visible)return e.visible instanceof Object?void(e.visible.value=!1):void(e.visible=!1);"function"!=typeof e.close?e.closeModal(this.$parent):e.close()},refreshHandle:function(e){"function"!=typeof e?!0===e&&("function"==typeof this.refresh?this.refresh():this.$dynamicBus.$emit("dynamicRefresh")):e()},emitEventHandle:function(e,t){"string"==typeof e&&this.$emit(e,t)},showTipHandle:function(e,t){!0===e&&this.$message&&this.$message({type:"success",message:t.msg||t.message||"操作成功"})},linkHandle:function(e){window.open(e.link,e.window)},routerHandle:function(e){(this.$router[e.routerAction]||this.$router.push)(e.router)},customActionHandle:function(e,t){"function"!=typeof e.actionHandle?console.warn("定义了未被识别的动作"+JSON.stringify(e)):e.actionHandle(t)},dialogPageHandle:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n="function"==typeof e.dataAdapter?e.dataAdapter:function(e){return e||{}};if(e.apiPromise)e.apiPromise(i).then(n).then((function(i){t.setCurrentDialogContent(e,i,r)}));else{var o=n(i);this.setCurrentDialogContent(e,o,r)}},dialogFormHandle:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n="function"==typeof e.dataAdapter?e.dataAdapter:function(e){return e||{}};if(e.apiPromise)e.apiPromise(i).then(n).then((function(i){t.setCurrentDialogForm(e,i,r)}));else{var o=n(i);this.setCurrentDialogForm(e,o,r)}},setCurrentDialogForm:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.currentDialogForm=Object(r.a)(Object(r.a)({container:"el-dialog"},Object(n.e)(e.dialog)),i),this.currentDialogForm.body.data=t,this.$globalDialogForm(this.currentDialogForm,this.actionBarWraper)},setCurrentDialogContent:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.currentDialogContent=Object(r.a)(Object(r.a)({container:"el-dialog"},Object(n.e)(e.dialog)),i),this.currentDialogContent.data=t,this.$globalDialogPage(this.currentDialogContent,this.actionBarWraper)}}}},749:function(e,t,i){},927:function(e,t,i){"use strict";i(749)},995:function(e,t,i){"use strict";i.r(t);var r=i(48),n=i(5),o=i(414),a=i(588),s=i(415),l={name:"DynamicCurd",props:{fields:{type:Array,required:!1,default:function(){return[]}},optionsProps:{type:Object,require:!0},isDebuggerMode:{type:Boolean,default:!0},apiPromises:{type:Object,default:function(){return{}}},entityLabel:String},mixins:[a.a],data:function(){return console.log("--optionsProps--",this.optionsProps),{searchParams:{refreshKey:""},pagination:{pageNo:1,pageSize:s.c.pageSize},total:1}},computed:{curdOpions:function(){var e=this;return Object(o.m)(Object(o.f)({searchForm:s.e,treeOption:s.g,pagination:s.c,topToolBar:{create:Object(o.f)(s.b,{label:"新增",permission:"新增",isloadData:!1,dialog:{properties:{title:"新增"+this.entityLabel,width:"60%"},body:{formItemList:Object(o.b)(this.fields,this.formSections),actions:{save:{apiPromise:this.apiPromises.create}}}}}),bulkdelete:Object(o.f)(s.d,{label:"批量删除",permission:"批量删除",popconfirm:{title:"确定删除选择的信息吗？"},apiPromise:this.apiPromises.bulkdelete||this.apiPromises.delete})},searchFields:Object(o.c)(this.fields),tableFields:Object(o.d)(this.fields),tableOption:Object(n.a)(Object(n.a)({},s.f),{},{loadListApi:this.apiPromises.list,"current-change":"handleCurrentChange",lineActions:{update:Object(o.f)(s.b,{label:"更新",permission:"更新",sort:0,dialog:{properties:{title:"新增表单"+this.entityLabel,width:"60%"},body:{formItemList:Object(o.b)(this.fields,this.formSections),actions:{save:{label:"更改",apiPromise:this.apiPromises.update}}}}}),detail:Object(o.f)(s.b,{label:"查看",permission:"查看",sort:0,apiPromise:this.apiPromises.detail,dialog:{properties:{title:this.entityLabel+"详情"},body:{props:{textModel:!0},formItemList:Object(o.b)(this.fields,this.formSections),btns:{save:null}}}}),delete:Object(o.f)(s.d,{label:"删除",sort:10,permission:"删除",apiPromise:this.apiPromises.delete||this.apiPromises.bulkdelete})}})},this.optionsProps,!0),(function(t,i){return"showTestTool"==t?!!e.isDebuggerMode:i[t]}))},queryParams:function(){return Object(n.a)(Object(n.a)({},this.searchParams),this.pagination)},loadListApiPromise:function(){var e=this;return this.curdOpions.tableOption.loadListApi(this.queryParams).then((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t=t.data||t,e.total=t.totalCount,t.list}))}},created:function(){var e=this;this.selected=[],this.pagination.pageSize=this.curdOpions.pagination.pageSize||this.pagination.pageSize,this.$dynamicBus.$on("dynamicRefresh",(function(){e.refresh()})),console.log("----this.curdOpions----",this.curdOpions)},methods:{handleSizeChange:function(e){this.refresh()},handleCurrentChange:function(e){this.pagination.pageNo=e,this.onSearch({pageNo:e})},treeClick:function(e,t){this.onSearch(Object(r.a)({},this.curdOpions.treeOption.fieldName,e[this.curdOpions.treeOption["node-key"]]))},onSearch:function(e){this.searchParams=Object(n.a)(Object(n.a)({},this.searchParams),e)},refresh:function(){var e=this.searchParams.refreshKey++;this.onSearch({refreshKey:e})},actionHandle:function(e){if(e.isloadData&&this.selected.length<1)this.$message({type:"warning",message:"您没有选择任何数据"});else{var t=e.isloadData?this.selected:null;this.actionHandles(e,t)}},selecctChange:function(e){this.selected=e}}},c=(i(927),i(36)),u=Object(c.a)(l,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("main",{staticClass:"p20 flex flex-direction"},[e.curdOpions.searchFields&&e.curdOpions.searchFields.length?i("DynamicSearchForm",{attrs:{fields:e.curdOpions.searchFields,options:e.curdOpions.searchForm},on:{search:e.onSearch}}):e._e(),e._v(" "),e.curdOpions.topToolBar?i("section",{staticClass:"my12 "},[i("DynamicActions",{attrs:{actions:e.curdOpions.topToolBar,actionData:e.selected,actionBarWraper:e.$parent.$el}})],1):e._e(),e._v(" "),i("section",{staticClass:"grid-wrap  full-width"},[e.curdOpions.treeOption?i("div",{staticClass:"scroll p10 border grid-col-4   grid-col-xs-12 grid-col-pp-24"},[i("el-tree",e._b({on:{"node-click":e.treeClick}},"el-tree",e.curdOpions.treeOption,!1))],1):e._e(),e._v(" "),i("section",{staticClass:"flex flex-direction",class:[e.curdOpions.treeOption?"grid-col-20  grid-col-xs-12 grid-col-pp-24":"grid-col-24"]},[i("DynamicTable",{staticClass:"table-wraper flex1",attrs:{table:e.curdOpions.tableOption,columns:e.curdOpions.tableFields,apiPromise:e.loadListApiPromise},on:{"selecct-change":e.selecctChange}}),e._v(" "),i("el-pagination",e._b({staticClass:"mt16",attrs:{background:"",total:e.total,pageSize:e.pagination.pageSize},on:{"size-change":e.handleSizeChange,"update:pageSize":function(t){return e.$set(e.pagination,"pageSize",t)},"update:page-size":function(t){return e.$set(e.pagination,"pageSize",t)},"current-change":e.handleCurrentChange}},"el-pagination",e.curdOpions.pagination,!1))],1)])],1)}),[],!1,null,"55fafcb6",null);t.default=u.exports}}]);
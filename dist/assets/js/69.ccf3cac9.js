(window.webpackJsonp=window.webpackJsonp||[]).push([[69],{589:function(e,t,i){"use strict";var o=i(17);t.a={props:{},computed:{},methods:{generateCreateOptions:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"dialog",t="router"==e?"routerDialogFormActionOption":"dialogFormActionOption";return Object(o.b)(t,{label:"新增",permission:"新增",router:"create",sort:50,isLoadData:!1,dialog:{properties:{title:"新增"+this.entityLabel,width:"60%"},body:{formItemList:Object(o.d)(this.fields,this.formSections),actions:{save:{apiPromise:this.apiPromises.create}}}}})},generateBulkDeleteOptions:function(){return Object(o.b)("requestApiActionOption",{label:"批量删除",permission:"批量删除",popconfirm:{title:"确定删除选择的信息吗？"},actionDataKey:"selected",apiPromise:this.apiPromises.bulkdelete||this.apiPromises.delete})},generateDeleteOptions:function(){return Object(o.b)("requestApiActionOption",{sort:200,label:"删除",permission:"删除",apiPromise:this.apiPromises.delete||this.apiPromises.bulkdelete})},generateUpdateOptions:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"dialog",t="router"==e?"routerDialogFormActionOption":"dialogFormActionOption";return Object(o.b)(t,{label:"编辑",router:"update",permission:"编辑",apiPromise:this.apiPromises.detail,dialog:{properties:{title:"编辑"+this.entityLabel,width:"60%"},body:{formItemList:Object(o.d)(this.fields,this.formSections),actions:{save:{label:"保存",apiPromise:this.apiPromises.update}}}}})},generateDetailOptions:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"dialog",t="router"==e?"routerDialogFormActionOption":"dialogFormActionOption";return Object(o.b)(t,{label:"详情",router:"detail",permission:"详情",apiPromise:this.apiPromises.detail,properties:{type:"default"},dialog:{properties:{title:this.entityLabel+"详情"},body:{props:{textModel:!0,formProperties:{"label-position":"left","label-width":"130px"}},formItemList:Object(o.c)(this.fields,this.formSections),actions:{save:null}}}})},generateActionOptions:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"dialog",t=this.generateCreateOptions(e),i=this.generateBulkDeleteOptions(),o=this.generateUpdateOptions(e),a=this.generateDetailOptions(e),s=this.generateDeleteOptions();return{createOptions:t,bulkdeleteOptions:i,updateOptions:o,detailOptions:a,deleteOptions:s}},generatePageActionOptions:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"dialog",t=this.generateCreateOptions(e),i=this.generateUpdateOptions(e),o=this.generateDetailOptions(e);return{create:t,update:i,detail:o}}}}},596:function(e,t,i){},667:function(e,t,i){"use strict";i(596)},791:function(e,t,i){"use strict";i.r(t);var o=i(48),a=i(5),s=i(17),n=i(161),r={name:"DynamicCurd",mixins:[i(589).a],props:{fields:{type:Array,required:!1,default:function(){return[]}},optionsProps:{type:Object,require:!0},isDebuggerMode:{type:Boolean,default:!0},mode:{type:String,default:"dialog"},apiPromises:{type:Object,default:function(){return{}}},formSections:{type:Object,default:function(){return{}}},entityLabel:String},data:function(){return{isEmpty:s.n,searchParams:{refreshKey:""},pagination:{pageNo:1,pageSize:n.b.pageSize},total:1,selected:[]}},computed:{options:function(){var e=this,t=this.generateActionOptions(this.mode),i=t.createOptions,o=t.bulkdeleteOptions,r=t.updateOptions,l=t.detailOptions,p=t.deleteOptions,c=Object(s.e)(this.fields),d=Object(s.f)(this.fields),h=Object(s.h)({searchForm:n.c,treeOption:n.e,pagination:n.b,topToolBar:{create:i,bulkdelete:o},searchFields:c,tableFields:d,tableOption:Object(a.a)(Object(a.a)({},n.d),{},{loadListApi:this.apiPromises.list,lineActions:{update:r,detail:l,delete:p}})},this.optionsProps,!0);return Object(s.q)(h,(function(t,i){return"showTestTool"==t?!!e.isDebuggerMode:i[t]}),!0)},queryParams:function(){return Object(a.a)(Object(a.a)({},this.searchParams),this.pagination)},loadListApiPromise:function(){var e=this,t=Object(a.a)({},this.queryParams);return delete t.refreshKey,this.options.tableOption.loadListApi(t).then((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t=t.data||t,e.total=t.totalCount,t.list}))},actionData:function(){return{selected:this.selected,queryParams:this.queryParams}}},created:function(){var e=this;this.searchParams=Object(a.a)(Object(a.a)({},this.searchParams),Object(s.l)(this.options.searchFields||[])),this.pagination.pageSize=this.options.pagination.pageSize||this.pagination.pageSize,this.$dynamicBus.$on("dynamicRefresh",(function(){e.refresh()}))},mounted:function(){},methods:{handleSizeChange:function(e){this.refresh()},handleCurrentChange:function(e){this.pagination.pageNo=e,this.onSearch({pageNo:e})},treeClick:function(e,t){this.onSearch(Object(o.a)({},this.options.treeOption.fieldName,e[this.options.treeOption["node-key"]]))},onSearch:function(e){this.searchParams=Object(a.a)(Object(a.a)({},this.searchParams),e)},refresh:function(){var e=this.searchParams.refreshKey++;this.onSearch({refreshKey:e})},selectChange:function(e){this.selected=e}}},l=(i(667),i(36)),p=Object(l.a)(r,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("main",{staticClass:" flex flex-direction"},[e.options.searchFields&&e.options.searchFields.length?i("DynamicSearchForm",{attrs:{fields:e.options.searchFields,options:e.options.searchForm},on:{search:e.onSearch}}):e._e(),e._v(" "),e.isEmpty(e.options.topToolBar)?e._e():i("section",{staticClass:"my12"},[i("DynamicActions",{attrs:{actions:e.options.topToolBar,actionData:e.actionData,actionBarWraper:e.$parent.$el}})],1),e._v(" "),i("section",{staticClass:"grid-wrap full-width"},[e.isEmpty(e.options.treeOption)?e._e():i("div",{staticClass:"scroll p10 border-grey grid-col-4 grid-col-xs-12 grid-col-pp-24"},[i("el-tree",e._b({on:{"node-click":e.treeClick}},"el-tree",e.options.treeOption,!1))],1),e._v(" "),i("section",{staticClass:"flex flex-direction",class:[e.options.treeOption?"grid-col-20  grid-col-xs-12 grid-col-pp-24":"grid-col-24"]},[i("DynamicTable",{staticClass:"table-wraper flex1",attrs:{table:e.options.tableOption,columns:e.options.tableFields,apiPromise:e.loadListApiPromise},on:{"selection-change":e.selectChange}}),e._v(" "),i("el-pagination",e._b({staticClass:"mt16",attrs:{background:"",total:e.total,pageSize:e.pagination.pageSize},on:{"size-change":e.handleSizeChange,"update:pageSize":function(t){return e.$set(e.pagination,"pageSize",t)},"update:page-size":function(t){return e.$set(e.pagination,"pageSize",t)},"current-change":e.handleCurrentChange}},"el-pagination",e.options.pagination,!1))],1)])],1)}),[],!1,null,"bf2d963e",null);t.default=p.exports}}]);
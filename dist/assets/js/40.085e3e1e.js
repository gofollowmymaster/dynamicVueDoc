(window.webpackJsonp=window.webpackJsonp||[]).push([[40],{420:function(t,e,n){var o=n(3),i=n(40),a=n(16),r=/"/g,c=o("".replace);t.exports=function(t,e,n,o){var l=a(i(t)),s="<"+e;return""!==n&&(s+=" "+n+'="'+c(a(o),r,"&quot;")+'"'),s+">"+l+"</"+e+">"}},421:function(t,e,n){var o=n(4);t.exports=function(t){return o((function(){var e=""[t]('"');return e!==e.toLowerCase()||e.split('"').length>3}))}},423:function(t,e,n){"use strict";var o=n(2),i=n(420);o({target:"String",proto:!0,forced:n(421)("link")},{link:function(t){return i(this,"a","href",t)}})},571:function(t,e,n){"use strict";n(423),n(29),n(59),n(119);var o=n(5),i=n(50),a=n(51),r=n(17);function c(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(e)return t.visible?t.visible instanceof Object?void(t.visible.value=!1):void(t.visible=!1):void("function"!=typeof t.close?c(t.$parent,e):t.close())}var l={reset:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e){var n=t.$refs.DynamicFormContent||t.$parent.$refs.DynamicFormContent;n?n.resetFields():console.warn("submit 动作 在组件中没有定义对应的 DynamicFormContent 表单 ref,")}},refresh:function(t,e){"function"!=typeof e?!0===e&&("function"==typeof t.refresh?t.refresh():t.$dynamicBus.$emit("dynamicRefresh")):e()},emitEvent:function(t,e,n){"string"==typeof e&&t.$emit(e,n)},closeModal:c,close:c,showTip:function(t,e,n){!0===e&&t.$message&&t.$message({type:"success",message:n.msg||n.message||"操作成功"})}},s={dialogForm:function(){function t(){Object(i.a)(this,t)}return Object(a.a)(t,null,[{key:"handle",value:function(t,e,n){this.vm=n;var i=t.dialog;"el-drawer"==i.container&&(i.properties=Object(o.a)({size:i.properties.width,direction:"rtl"},i.properties)),this.dialogFormHandle(t,e)}},{key:"dialogFormHandle",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i="function"==typeof t.dataAdapter?t.dataAdapter:function(t){return t||{}};if(t.apiPromise)t.apiPromise(n).then(i).then((function(n){e.setCurrentDialogForm(t,n,o)}));else{var a=i(n);this.setCurrentDialogForm(t,a,o)}}},{key:"setCurrentDialogForm",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=Object(o.a)(Object(o.a)({container:"el-dialog"},Object(r.g)(t.dialog)),n);i.body.data=e,"function"!=typeof this.vm.setGlobalDialogForm?this.vm.$globalDialogForm(i,this.vm.actionBarWraper):this.vm.setGlobalDialogForm(i)}}]),t}(),dialogPage:function(){function t(){Object(i.a)(this,t)}return Object(a.a)(t,null,[{key:"handle",value:function(t,e,n){this.vm=n;var i=t.dialog;"el-drawer"==i.container&&(i.properties=Object(o.a)({size:i.properties.width,direction:"rtl"},i.properties)),this.dialogPageHandle(t,e)}},{key:"dialogPageHandle",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i="function"==typeof t.dataAdapter?t.dataAdapter:function(t){return t||{}};if(t.apiPromise)t.apiPromise(n).then(i).then((function(n){e.setCurrentDialogContent(t,n,o)}));else{var a=i(n);this.setCurrentDialogContent(t,Object(r.a)(a),o)}}},{key:"setCurrentDialogContent",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=Object(o.a)(Object(o.a)({container:"el-dialog"},Object(r.g)(t.dialog)),n);i.data=e,"function"!=typeof this.vm.setGlobalDialogPage?this.vm.$globalDialogPage(i,this.vm.actionBarWraper):this.vm.setGlobalDialogPage(i)}}]),t}(),requestApi:function(){function t(){Object(i.a)(this,t)}return Object(a.a)(t,null,[{key:"handle",value:function(t,e,n){var o=this;this.vm=n;var i="function"==typeof t.dataAdapter?t.dataAdapter:function(t){return t};t.apiPromise(e).then(i).then((function(e){return o.actionCallback(t,e),e}))}},{key:"actionCallback",value:function(t,e){if(t.callback instanceof Object)for(var n in t.callback)"function"==typeof t.callback[n]&&t.callback[n](this.vm,e),"function"==typeof l[n]&&l[n](this.vm,t.callback[n],e)}}]),t}(),download:function(){function t(){Object(i.a)(this,t)}return Object(a.a)(t,null,[{key:"handle",value:function(t,e,n){var o=this;this.vm=n;var i="function"==typeof t.dataAdapter?t.dataAdapter:function(t){return t};t.apiPromise(e).then(i).then((function(e){var n,o,i=null!==(n=t.fileName)&&void 0!==n?n:null===(o=e.headers["content-disposition"])||void 0===o?void 0:o.replace(/.*=(.*\.\w+)/g,"$1");Object(r.j)(e.data,decodeURIComponent(i))})).then((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return o.actionCallback(t,e),e}))}},{key:"actionCallback",value:function(t,e){if(t.callback instanceof Object)for(var n in t.callback)"function"==typeof t.callback[n]&&t.callback[n](this.vm,e),"function"==typeof l[n+"Handle"]&&l[n+"Handle"](this.vm,t.callback[n],e)}}]),t}()};e.a={props:{},computed:{},inject:["setGlobalDialogForm","setGlobalDialogPage"],methods:{actionHandles:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;switch(t.actionType){case"dialogPage":case"dialogForm":case"requestApi":case"download":s[t.actionType].handle(t,e,this);break;case"submit":case"reset":case"close":case"link":case"router":"function"==typeof this[t.actionType+"Handle"]&&this[t.actionType+"Handle"](t,e),l[t.actionType]&&l[t.actionType](this);break;case"routerDialogPage":case"routerDialogForm":this.routerDialogHandle(t,e);break;default:this.customActionHandle(t,e)}},submitHandle:function(t){var e=this,n=this.$refs.DynamicFormContent||this.$parent.$refs.DynamicFormContent;n?n.validate((function(n,o){n&&s.requestApi.handle(t,o,e)})):console.warn("submit 动作 在组件中没有定义对应的 DynamicFormContent 表单 ref,")},linkHandle:function(t){window.open(t.link,t.window)},routerHandle:function(t,e){var n="function"==typeof t.router?t.router(e):t.router;this.$router[t.routerAction||"push"](n)},routerDialogHandle:function(t,e){var n,o=t.mainKey||"id",i={};"function"==typeof t.router?n=t.router(e):(n=this.$route.fullPath.replace(/[\/|\\]$/,"")+"/",t=t.router&&"string"==typeof t.router?t.router.replace(/[\/|\\]$/,"")+"/":t.actionKey,i={id:null==e?void 0:e[o],action:t}),this.$router[t.routerAction||"push"]({path:n,query:i})},customActionHandle:function(t,e){"function"!=typeof t.actionHandle?console.warn("定义了未被识别的动作"+JSON.stringify(t)):t.actionHandle(e)}}}},594:function(t,e,n){},665:function(t,e,n){"use strict";n(594)},711:function(t,e,n){"use strict";n.r(e);var o=n(5),i=n(49),a=(n(38),n(11),n(84),n(238),n(246),{name:"DynamicFormDialog",mixins:[n(571).a],props:{visible:{type:Object,default:function(){return{value:!1}}},container:{type:String,default:"el-dialog"},body:{type:Object,default:function(){return{}}},properties:{type:Object,default:function(){return{}}}},computed:{actionsOrdered:function(){var t=Object.entries(this.body.actions).map((function(t,e){var n=Object(i.a)(t,2),a=n[0],r=n[1];return Object(o.a)(Object(o.a)({},r),{},{actionKey:a})})).filter((function(t){return t.actionType}));return t.sort((function(t,e){return t.sort-e.sort})),t}},mounted:function(){console.log(this)},components:{},methods:{reset:function(){this.$refs.DynamicFormContent.resetFields()},actionHandle:function(t){this.actionHandles(t)},formDataUpdateHandle:function(t,e){this.body.formDataUpdateHandle&&this.body.formDataUpdateHandle(t,e)},closeModal:function(){this.visible.value=!1}}}),r=(n(665),n(36)),c=Object(r.a)(a,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n(t.container,t._b({tag:"component",attrs:{visible:t.visible.value,"custom-class":"hz-low-code","append-to-body":!0},on:{"update:visible":function(e){return t.$set(t.visible,"value",e)}}},"component",t.properties,!1),[t.visible.value?n("section",[n("DynamicFormContent",t._b({ref:"DynamicFormContent",staticClass:"dialog-height over-scroll ",attrs:{data:t.body.data,formItemList:t.body.formItemList},on:{formDataUpdated:t.formDataUpdateHandle}},"DynamicFormContent",t.body.props,!1)),t._v(" "),n("section",{staticClass:"flex pt12",class:{"align-right":"dialog"==t.container}},t._l(t.actionsOrdered,(function(e){return n("el-button",t._b({directives:[{name:"permission",rawName:"v-permission",value:e.permission,expression:"action.permission"}],key:e.label,on:{click:function(n){return t.actionHandle(e)}}},"el-button",e.properties,!1),[t._v("\n        "+t._s(e.label)+"\n      ")])})),1)],1):t._e()])}),[],!1,null,"861d6802",null);e.default=c.exports}}]);